<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Matrix Factorization with PyTorch using movielens dataset -bbangjo </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="MF PyTorch implementation- Matrix Factorization with PyTorch using movielens dataset"> <meta name="keywords" content="Matrix Factorization with PyTorch using movielens dataset, bbangjo, Recommendation System,"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="bbangjo" property="og:site_name" /> <meta content="Matrix Factorization with PyTorch using movielens dataset" property="og:title" /> <meta content="article" property="og:type" /> <meta content="MF PyTorch implementation" property="og:description" /> <meta content="https://www.bbangjo.kr/blog/recsys-mfpytorch" property="og:url" /> <meta content="2021-02-18T00:00:00+00:00" property="article:published_time" /> <meta content="https://www.bbangjo.kr/about/" property="article:author" /> <meta content="https://www.bbangjo.krhttps://user-images.githubusercontent.com/51329156/100218541-381d3d80-2f58-11eb-8d71-438e9ed9112f.png" property="og:image" /> <meta content="Recommendation System" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Matrix Factorization with PyTorch using movielens dataset" /> <meta name="twitter:url" content="https://www.bbangjo.kr/blog/recsys-mfpytorch" /> <meta name="twitter:description" content="MF PyTorch implementation" /> <link rel="stylesheet" href="https://www.bbangjo.kr/assets/css/main.css" /> <!-- <link rel="stylesheet" href="https://www.bbangjo.kr/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="https://www.bbangjo.kr/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="https://www.bbangjo.kr/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="https://www.bbangjo.kr/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="https://www.bbangjo.kr/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="https://www.bbangjo.kr/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'https://www.bbangjo.kr' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="https://www.bbangjo.kr/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="https://www.bbangjo.kr/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="https://www.bbangjo.kr/assets/js/search.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!-- Maker widget <script> (function(d, h, m) { var js, fjs = d.getElementsByTagName(h)[0]; if (d.getElementById(m)) { return; } js = d.createElement(h); js.id = m; js.onload = function() { window.makerWidgetComInit({ position: "left", widget: "ofeeof264otl2l5g-zspk40eq2gaomj2n-higi2qphmveubksi" }); }; js.src = "https://makerwidget.com/js/embed.js"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "dhm"); </script> --> <!-- buy me a coffeee <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sujaykundu" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="right" data-x_margin="10" data-y_margin="10" ></script> --> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">bbangjo</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="https://www.bbangjo.kr/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="https://www.bbangjo.kr/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="https://www.bbangjo.kr/blog" >Blog</a > </li> </ul> </div> <!-- <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link" href="https://www.bbangjo.kr/get-started"> Get Started </a> </li> --> <!-- <li class="nav-item"> <a class="nav-link" id="olvy-target"> What's New </a> </li> --> <!-- <li class="nav-item"> <a class="nav-link" href="https://www.bbangjo.kr/styleguide"> Styleguide </a> </li> <li class="nav-item"> <button id="olvy-target" class="btn btn-dark"> What's New </button> </li> --> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <!-- <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher()" type="checkbox" name="checkbox" /> </li> --> </ul> </nav> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Matrix Factorization with PyTorch using movielens dataset</h1> <h4 class="post-meta">MF PyTorch implementation</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="https://www.bbangjo.kr/blog/authors/bbangjo">bbangjo</a></span> </span > at <time datetime="2021-02-18 00:00:00 +0000" itemprop="datePublished" >Feb 18, 2021</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/recsys-mfpytorch" ></span> <div class="post-categories"> Category : <a href="/blog/categories/Recommendation System" >Recommendation System</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="https://user-images.githubusercontent.com/51329156/100218541-381d3d80-2f58-11eb-8d71-438e9ed9112f.png" alt="" /> <br /> <br /> <p>ì˜¤ëœë§Œì— ê¸€ì…ë‹ˆë‹¤. ìµœê·¼ì— ë„ˆë¬´ ë‚˜íƒœí•˜ê²Œ ì‚° ê²ƒ ê°™ì•„ í˜„íƒ€ê°€ ì˜¤ë„¤ìš”.. í•´í‚¹ê³µë¶€ì™€ ì¶”ì²œ ì‹œìŠ¤í…œ ê³µë¶€ë¥¼ ì´ë²ˆ ë°©í•™ì—ëŠ” ì£¼ë¡œ í•´ì™”ëŠ”ë°, ì¶”ì²œì‹œìŠ¤í…œì˜ í˜‘ì—… í•„í„°ë§ ë°©ì‹ ì¤‘ Model-basedì˜ ëŒ€í‘œì ì¸ ê¸°ìˆ  <strong>Matrix Factorization(ì´í•˜ MF)</strong>ì„ pytorchë¡œ êµ¬í˜„í•œ ê²ƒì— ëŒ€í•´ ì´ì•¼ê¸°í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.</p> <p>í˜‘ì—… í•„í„°ë§ê³¼ MFì— ëŒ€í•´ ì •ë¦¬í•œ ê¸€ì´ ë§ì€ë°, ê¶ê¸ˆí•˜ì‹  ë¶„ë“¤ì€ ê°ê° <a href="https://scvgoe.github.io/2017-02-01-%ED%98%91%EC%97%85-%ED%95%84%ED%84%B0%EB%A7%81-%EC%B6%94%EC%B2%9C-%EC%8B%9C%EC%8A%A4%ED%85%9C-(Collaborative-Filtering-Recommendation-System)/">ì—¬ê¸°</a>ì™€ <a href="https://jeongchul.tistory.com/553">ì—¬ê¸°</a>ë¥¼ ì°¸ê³ í•˜ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p> <p>ì œê°€ êµ¬í˜„ ì‹¤ë ¥ì´ ë›°ì–´ë‚œ ê²ƒì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì°¸ê³ ë§Œ í•œë‹¤ëŠ” ëŠë‚Œìœ¼ë¡œ ë´ì£¼ì‹­ì‡¼ğŸ¤£</p> <h2 id="-í”„ë¡œí† íƒ€ì…">ğŸ“„ í”„ë¡œí† íƒ€ì…</h2> <p>ì €ëŠ” PyTorchë¡œ ê°œë°œí•  ë•Œ ì½”ë“œë¥¼ ì´ 6ë¶€ë¶„ìœ¼ë¡œ êµ¬ë¶„í•©ë‹ˆë‹¤.</p> <ul> <li><strong>Setting</strong></li> <li><strong>Dataset &amp; Dataloader</strong></li> <li><strong>Model</strong></li> <li><strong>Criterion(loss function) &amp; Optimizer</strong></li> <li><strong>train &amp; test</strong></li> <li><strong>run</strong></li> </ul> <p>ì²˜ìŒ ì½”ë“œê°€ ì‹œì‘í•  ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¥¼ ê°€ì§€ê² ë„¤ìš”.</p> <p><strong>MF.py</strong> :</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="p">...</span>

<span class="c1"># Setting 
</span><span class="k">def</span> <span class="nf">check_positive</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentError</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s"> is invalid value. epochs should be positive integer'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">val</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">'matrix factorization with pytorch'</span><span class="p">)</span>
<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--epochs'</span><span class="p">,</span> <span class="s">'-e'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">check_positive</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--batch'</span><span class="p">,</span> <span class="s">'-b'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">check_positive</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--lr'</span><span class="p">,</span> <span class="s">'-l'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'learning rate'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>


<span class="c1"># Dataset &amp; Dataloader
</span>
<span class="c1"># Model
</span>
<span class="c1"># Criterion &amp; Optimizer
</span>
<span class="c1"># train &amp; test
</span>
<span class="c1"># run
</span></code></pre></div></div> <h3 id="dataset--dataloader">Dataset / Dataloader</h3> <p>PyTorchì—ì„œëŠ” MNIST ê°™ì´ ìœ ëª…í•œ ë°ì´í„°ì— ëŒ€í•´ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë‚´ì¥ëœ ë°ì´í„°ì…‹ì„ ì œê³µí•©ë‹ˆë‹¤. ê·¸ëŸ°ë° movielensëŠ” ì—†ë”ë¼êµ¬ìš” ã… ã…  ê·¸ë˜ì„œ í•œë²ˆ ë§Œë“¤ì–´ë´¤ìŠµë‹ˆë‹¤. ì´ ê³¼ì •ì´ í•„ìˆ˜ëŠ” ì•„ë‹ˆì§€ë§Œ PyTorchì—ì„œ ì œê³µí•˜ëŠ” <strong>Dataloader</strong>ëŠ” ì „ì²´ ë°ì´í„°ì…‹ì„ ì—¬ëŸ¬ batchë“¤ë¡œ ë‚˜ëˆ„ê³ , ì„ê³ , ë°˜ë³µì ìœ¼ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. ê·¸ê²ƒë„ ì•„ì£¼ ì‰¬ìš´ ë°©ë²•ìœ¼ë¡œìš”! ğŸ‘ ê·¸ë˜ì„œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì„ ë‹¨ìˆœí™”í•  ìˆ˜ ìˆê³ , ì½”ë“œì˜ ê°€ë…ì„±ë„ ë†’ì—¬ì¤ë‹ˆë‹¤.</p> <p>ì €ëŠ” movielens dataset ì„ ì‚¬ìš©í–ˆëŠ”ë°, <a href="https://grouplens.org/datasets/movielens/">ì—¬ê¸°</a>ì— ê°€ì‹œë©´ ì—¬ëŸ¬ ì¢…ë¥˜ì˜ ë°ì´í„°ì…‹ì´ ìˆìŠµë‹ˆë‹¤. ì €ëŠ” ì´ ì¤‘ <strong>MovieLens Latest Datasets</strong>ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.</p> <p>ì´ íŒŒíŠ¸ì—ì„œ ì €í¬ê°€ í•´ì•¼í•  ì¼ì€ ì»¤ìŠ¤í…€ ë°ì´í„°ì…‹ì„ <code class="language-plaintext highlighter-rouge">torch.utils.data.Dataset</code>ì— ìƒì†í•˜ê³ , ì•„ë˜ì™€ ê°™ì€ ë©”ì†Œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p> <ul> <li><code class="language-plaintext highlighter-rouge">len(dataset)</code> ì—ì„œ í˜¸ì¶œë˜ëŠ” <code class="language-plaintext highlighter-rouge">__len__</code> ì€ ë°ì´í„°ì…‹ì˜ í¬ê¸°ë¥¼ ë¦¬í„´í•´ì•¼í•©ë‹ˆë‹¤.</li> <li><code class="language-plaintext highlighter-rouge">dataset[i]</code> ì—ì„œ í˜¸ì¶œë˜ëŠ” <code class="language-plaintext highlighter-rouge">__getitem__</code> ì€ ië²ˆì§¸ ìƒ˜í”Œì„ ì°¾ëŠ”ë° ì‚¬ìš©ë©ë‹ˆë‹¤.</li> </ul> <p><a href="https://tutorials.pytorch.kr/beginner/data_loading_tutorial.html">ì—¬ê¸°</a>ì— ìì„¸í•œ ì„¤ëª…ì´ ë‚˜ì™€ìˆìœ¼ë‹ˆ ë³´ë©´ì„œ ë”°ë¼í•˜ì‹œë©´ ì‰½ê²Œ í•˜ì‹¤ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤.</p> <p>movielens datasetì„ ë‹¤ìš´ë¡œë“œ ë°›ìœ¼ë©´ ì—¬ëŸ¬ csv íŒŒì¼ì´ ìˆëŠ”ë° ê·¸ ì¤‘ ì €í¬ê°€ ì‚¬ìš©í•  ë°ì´í„°ì…‹ì€ <code class="language-plaintext highlighter-rouge">ratings.csv</code> ì…ë‹ˆë‹¤. ì™œëƒí•˜ë©´ <strong>í˜‘ì—… í•„í„°ë§</strong>ì˜ Model based ë°©ì‹ì¸ MFë¥¼ êµ¬í˜„ ì¤‘ ì´ë‹ˆê¹Œìš”!ğŸ˜ â€œ<code class="language-plaintext highlighter-rouge">User u</code>ê°€ <code class="language-plaintext highlighter-rouge">Item i</code>ì— ëŒ€í•´ <code class="language-plaintext highlighter-rouge">Rating r</code>ì„ ë‚¨ê²¼ë‹¤â€ ë¼ëŠ” ì‚¬ì‹¤ì„ ì•Œê³  ì‹¶ì€ ê²ë‹ˆë‹¤.</p> <p><img src="https://user-images.githubusercontent.com/51329156/106460584-e9030400-64d6-11eb-91b9-d229df2292b9.png" alt="image" /></p> <p>ì´ ì¤‘ ì €í¬ê°€ í˜„ì¬ë¡œì¨ëŠ” í•„ìš”ì—†ëŠ” <code class="language-plaintext highlighter-rouge">timestamp</code> ì»¬ëŸ¼ì„ ì˜ë¼ë‚´ê³  ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤. csvíŒŒì¼ì„ dataframeìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ <strong>pandas</strong> ëª¨ë“ˆì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.</p> <p><strong>MF.py</strong> :</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="p">...</span>
<span class="c1"># Setting
# Dataset &amp; Dataloader
</span><span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/movielens/ratings.csv'</span><span class="p">).</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">])</span>

<span class="c1"># Model
</span>
<span class="c1"># Criterion &amp; Optimizer
</span>
<span class="c1"># train &amp; test
</span>
<span class="c1"># run
</span></code></pre></div></div> <p>ê·¸ë¦¬ê³  ìœ„ì—ì„œ ì„¤ëª…í•œëŒ€ë¡œ <code class="language-plaintext highlighter-rouge">torch.utils.data.Dataset</code>ì— ìƒì†í•œ ì»¤ìŠ¤í…€ ë°ì´í„°ì…‹ì„ ë§Œë“¤ê³  ë‘ ë©”ì†Œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œí•˜ë©´ ë©ë‹ˆë‹¤. ì €ëŠ” ë°ì´í„°ë¥¼ í•™ìŠµìš©, í‰ê°€ìš©ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ìœ„í•´ <strong>sklearn</strong>ì—ì„œ ì œê³µí•˜ëŠ” <code class="language-plaintext highlighter-rouge">train_test_split</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">__getitem__</code>ì—ì„œëŠ” indexë¥¼ ë°›ì•„ indexì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ë¥¼ ë½‘ê³ , <code class="language-plaintext highlighter-rouge">__len__</code>ì—ì„œëŠ” ë°ì´í„°ì…‹ì˜ ì‚¬ì´ì¦ˆë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</p> <p>ê·¸ë¦¬ê³  ë§Œë“  ë°ì´í„°ì…‹ì„ ì´ìš©í•´ì„œ ë°ì´í„°ë¡œë”ê¹Œì§€ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.</p> <p><strong>MF.py</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="p">...</span>

<span class="c1"># Dataset &amp; Dataloader
</span><span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/movielens/ratings.csv'</span><span class="p">).</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">])</span>

<span class="k">class</span> <span class="nc">MovieLensDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="s">"""
    :param df: rating dataframe, columns: ['userId', 'movieId', 'rating', ...]
    :param train: Using train_test_split from sklearn, if True, train_df is used else test_df.
    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">train_size</span> <span class="o">=</span> <span class="n">train_size</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">test_size</span> <span class="o">=</span> <span class="n">test_size</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">train_df</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">test_df</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">test_size</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">train_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">train</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">train_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">test_df</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">df</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">LongTensor</span><span class="p">([</span><span class="bp">self</span><span class="p">.</span><span class="n">df</span><span class="p">.</span><span class="n">userId</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">]])</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">LongTensor</span><span class="p">([</span><span class="bp">self</span><span class="p">.</span><span class="n">df</span><span class="p">.</span><span class="n">movieId</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">]])</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="bp">self</span><span class="p">.</span><span class="n">df</span><span class="p">.</span><span class="n">rating</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">]])</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
    
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">MovieLensDataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">ratings_df</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">MovieLensDataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">ratings_df</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="c1"># Model
</span>
<span class="c1"># Criterion &amp; Optimizer
</span>
<span class="c1"># train &amp; test
</span>
<span class="c1"># run
</span></code></pre></div></div> <p>ì´ì œ ì €í¬ê°€ ì‚¬ìš©í•  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ì‚¬ìš©í•  ì¤€ë¹„ë¥¼ ë§ˆì³¤ìŠµë‹ˆë‹¤! ğŸ‰</p> <h3 id="model">Model</h3> <p>ì´ì œ Matrix Factorizationì„ ìˆ˜í–‰í•  ëª¨ë¸ì„ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤. Matrix Factoriztionì— ëŒ€í•´ ê°„ë‹¨íˆ ì„¤ëª…ë“œë¦¬ë©´, â€œUserì™€ Itemì„ ê°ê° latent vectorë¡œ í‘œí˜„í•œ í›„, ì´ ë‘˜ì„ í–‰ë ¬ê³±â€í•´ì„œ â€œì›ë˜ì˜ Interaction Matrixë¥¼ ì˜ˆì¸¡ / ì™„ì„±â€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. latent vectorëŠ” ê°ê°ì˜ ìš”ì†Œê°€ ê°€ì§€ê³  ìˆëŠ” ì ì¬ì ì¸ íŠ¹ì„±ì„ ì»´í“¨í„°ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” â€˜ê°’â€™ë“¤ë¡œ ë‚˜íƒ€ë‚¸ ê²ƒì´ë¼ ìƒê°í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p> <p><strong>ì˜ˆì¸¡</strong>ì€ ì›ë˜ì˜ ê°’ê³¼ ëª¨ë¸ì´ ë§Œë“¤ì–´ ë‚¸ ê°’ê³¼ì˜ ì°¨ì´ë¥¼ ì¤„ì´ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. ë•Œë¬¸ì— ì´ ê³¼ì •ì€ <strong>Criterion</strong>ì—ì„œ ì²˜ë¦¬í•©ë‹ˆë‹¤. ê·¸ëŸ¼ ì´ íŒŒíŠ¸ì—ì„œ í•´ì•¼í•˜ëŠ” ì¼ì€ â€œUserì™€ Itemì„ ê°ê° latent vectorë¡œ í‘œí˜„í•œ í›„, ì´ ë‘˜ì„ í–‰ë ¬ê³±â€í•˜ëŠ” ë¶€ë¶„ì´ê² ë„¤ìš”.</p> <p>latent vectorë¡œ í‘œí˜„í•˜ëŠ” ê²ƒì€ ì„ë² ë”©ì„ ì‚¬ìš©í•´ë„ ë˜ê³ , ëœë¤ê°’ì„ ì‚¬ìš©í•´ë„ ë©ë‹ˆë‹¤. ì €ëŠ” ì„ë² ë”©ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.</p> <p><strong>MF: py</strong> :</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="p">...</span>

<span class="c1"># Dataset &amp; Dataloader
</span><span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/movielens/ratings.csv'</span><span class="p">).</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">])</span>
<span class="n">n_users</span><span class="p">,</span> <span class="n">n_items</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">batch</span> <span class="o">*</span> <span class="n">ratings_df</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">.</span><span class="n">batch</span> <span class="o">*</span> <span class="n">ratings_df</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">...</span> 
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">MovieLensDataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">ratings_df</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">MovieLensDataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">ratings_df</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="c1"># Model
</span><span class="k">class</span> <span class="nc">MatrixFacotirzation</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_users</span><span class="p">,</span> <span class="n">n_items</span><span class="p">,</span> <span class="n">n_factor</span> <span class="o">=</span> <span class="mi">20</span><span class="p">):</span>
        <span class="s">"""
        :param n_users: number of users
        :param n_items: number of items
        :param n_factor: size of latent vector 

        """</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">user_embedding</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">num_embeddings</span><span class="o">=</span> <span class="n">n_users</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="o">=</span><span class="n">n_factor</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">item_embedding</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">num_embeddings</span><span class="o">=</span><span class="n">n_items</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="o">=</span><span class="n">n_factor</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="p">.</span><span class="n">bmm</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">user_embedding</span><span class="p">(</span><span class="n">user</span><span class="p">),</span> <span class="n">torch</span><span class="p">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">item_embedding</span><span class="p">(</span><span class="n">item</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># (32,1,100) x (32,100,1)
</span><span class="n">model</span> <span class="o">=</span> <span class="n">MatrixFacotirzation</span><span class="p">(</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_items</span><span class="p">,</span> <span class="n">n_factor</span><span class="o">=</span><span class="mi">100</span><span class="p">).</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="c1"># Criterion &amp; Optimizer
</span>
<span class="c1"># train &amp; test
</span>
<span class="c1"># run
</span></code></pre></div></div> <p>ê° userì™€ itemì„ 100ì°¨ì›ì˜ latent vectorë¡œ ë‚˜íƒ€ë‚¸ í›„ <code class="language-plaintext highlighter-rouge">torch.bmm</code>ì„ ì´ìš©í•´ <strong>batch matmul</strong>ì„ í•´ì£¼ê³  ìˆìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">bmm()</code>ì„ ì‚¬ìš©í•œ ì´ìœ ëŠ” dataloaderê°€ datasetì˜ <code class="language-plaintext highlighter-rouge">__getitem__()</code>ì„ ì´ìš©í•´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ ì§€ì •í•´ì¤€ batch_size ë§Œí¼ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ê·¸ë˜ì„œ í…ì„œì˜ í˜•íƒœê°€ ì›ë˜ëŠ” <code class="language-plaintext highlighter-rouge">(1,)</code>ë¼ë©´, batch_sizeê°€ 32ì¼ ë•Œ <code class="language-plaintext highlighter-rouge">(32,1)</code>ì´ ë˜ëŠ”ê±°ì£ . ì´ëŸ´ ë•Œ batch_sizeë¥¼ ì‹ ê²½ì•ˆì“°ê³  ê°€ì ¸ì˜¨ í–‰ë ¬ë¼ë¦¬ì˜ ê³±ë§Œ í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ <code class="language-plaintext highlighter-rouge">bmm()</code>ì…ë‹ˆë‹¤. í–‰ë ¬ê³±ì„ ìœ„í•´ Itemì€ transposeí•´ì£¼ì—ˆìŠµë‹ˆë‹¤.</p> <h3 id="criterion--optimizer">Criterion &amp; Optimizer</h3> <p>ì´ì œ ëª¨ë¸ë„ ë§Œë“¤ì—ˆìœ¼ë‹ˆ loss functionê³¼ optimizerë¥¼ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì´ ë¶€ë¶„ì€ PyTorchì— ë‚´ì¥ëœ ê²ƒì„ ì“°ë©´ ë˜ê¸° ë•Œë¬¸ì— ì½”ë“œ ëª‡ ì¤„ë¡œ ëë‚´ë©´ ë©ë‹ˆë‹¤. ë‹¤ë§Œ ì €í¬ê°€ ì‚¬ìš©í•  <strong>RMSELoss</strong>ëŠ” PyTorchì—ì„œ ì œê³µí•´ì£¼ì§€ ì•Šì•„ì„œ, <code class="language-plaintext highlighter-rouge">MSELoss()</code>ì˜ ê²°ê³¼ê°’ì— square rootë¥¼ ì·¨í–ˆìŠµë‹ˆë‹¤.</p> <p><strong>MF.py</strong> :</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="p">...</span>

<span class="c1"># Dataset &amp; Dataloader
</span><span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/movielens/ratings.csv'</span><span class="p">).</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">])</span>
<span class="n">n_users</span><span class="p">,</span> <span class="n">n_items</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">batch</span> <span class="o">*</span> <span class="n">ratings_df</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">.</span><span class="n">batch</span> <span class="o">*</span> <span class="n">ratings_df</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">...</span> 
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">MovieLensDataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">ratings_df</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">MovieLensDataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">ratings_df</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="c1"># Model
</span><span class="p">...</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MatrixFacotirzation</span><span class="p">(</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_items</span><span class="p">,</span> <span class="n">n_factor</span><span class="o">=</span><span class="mi">100</span><span class="p">).</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="c1"># Criterion &amp; Optimizer
</span><span class="k">class</span> <span class="nc">RMSEloss</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="s">"""
    square root of MSELoss()
    According to docs(https://pytorch.org/docs/stable/generated/torch.nn.MSELoss.html), 
    'mean' is set by default for 'reduction' and can be avoided by 'reduction="sum"'
    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">mse</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">MSELoss</span><span class="p">().</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">eps</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="n">eps</span><span class="p">]).</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">rating</span><span class="p">):</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">mse</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">rating</span><span class="p">).</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">eps</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">loss</span>

<span class="n">criterion</span> <span class="o">=</span> <span class="n">RMSEloss</span><span class="p">().</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="p">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">lr</span><span class="p">)</span>
<span class="c1"># train &amp; test
</span>
<span class="c1"># run
</span></code></pre></div></div> <h3 id="train--test"><strong>train &amp; test</strong></h3> <p>ê±°ì˜ ë‹¤ ì™”ë„¤ìš”! ğŸ‘ ì´ì œ í•™ìŠµ, í‰ê°€ë¥¼ ìˆ˜í–‰í•  ê°ê°ì˜ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì£¼ë©´ ëì…ë‹ˆë‹¤. ì „ì²´ì ì¸ íë¦„ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p> <ul> <li><strong>dataloader</strong>ë¥¼ ì´ìš©í•´ ì „ì²´ ë°ì´í„°ë¥¼ ìª¼ê°  batchì— ì ‘ê·¼ <ul> <li><strong>model</strong>ì„ ì´ìš©í•´ ì˜ˆì¸¡</li> <li>ì‹¤ì œ ê°’ê³¼ ë¹„êµ, lossê°’ ê³„ì‚°</li> <li><code class="language-plaintext highlighter-rouge">backward()</code> ìˆ˜í–‰</li> <li>íŒŒë¼ë¯¸í„° ìˆ˜ì •</li> </ul> </li> </ul> <p>ê°ê°ì˜ ê³¼ì •ì´ ì´ë¯¸ ì½”ë“œë¡œ ì§œì—¬ì ¸ ìˆê±°ë‚˜, PyTorch ë‚´ë¶€ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ê¸° ë•Œë¬¸ì— ì´ ë¶€ë¶„ë„ ì½”ë“œ ëª‡ ì¤„ë¡œ ëë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²°ê³¼ë¥¼ ì €ì¥í•˜ê³ , ì¶œë ¥í•˜ëŠ” ì½”ë“œë§Œ ì¡°ê¸ˆ ê³ë“¤ì´ë©´ ë˜ê² ë„¤ìš”. train ê³¼ testëŠ” ê°ê° train_dataset, test_datasetì„ ì‚¬ìš©í•˜ëŠ” ë™ì¼í•œ ê³¼ì •ì…ë‹ˆë‹¤.</p> <p><strong>MF.py</strong> :</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="p">...</span>

<span class="c1"># Dataset &amp; Dataloader
</span><span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/movielens/ratings.csv'</span><span class="p">).</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">])</span>
<span class="n">n_users</span><span class="p">,</span> <span class="n">n_items</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">batch</span> <span class="o">*</span> <span class="n">ratings_df</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">.</span><span class="n">batch</span> <span class="o">*</span> <span class="n">ratings_df</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">...</span> 
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">MovieLensDataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">ratings_df</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">MovieLensDataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">ratings_df</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="c1"># Model
</span><span class="p">...</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MatrixFacotirzation</span><span class="p">(</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_items</span><span class="p">,</span> <span class="n">n_factor</span><span class="o">=</span><span class="mi">100</span><span class="p">).</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="c1"># Criterion &amp; Optimizer
</span><span class="p">...</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">RMSEloss</span><span class="p">().</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="p">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">lr</span><span class="p">)</span>
<span class="c1"># train &amp; test
</span><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>
    <span class="n">process</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">model</span><span class="p">.</span><span class="n">train</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
        <span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">user</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">item</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">target</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="p">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">),</span> <span class="n">start_dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">).</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="n">loss</span><span class="p">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="p">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">process</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">.</span><span class="n">item</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span> <span class="p">(</span><span class="sa">f</span><span class="s">'[*] Epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s"> [</span><span class="si">{</span><span class="n">idx</span> <span class="o">*</span> <span class="n">args</span><span class="p">.</span><span class="n">batch</span><span class="si">}</span><span class="s"> / </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span><span class="si">}</span><span class="s">] RMSE: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">process</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">process</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">process</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">process</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="n">process</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">model</span><span class="p">.</span><span class="n">train</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">):</span>
        <span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">user</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">item</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">target</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="p">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">),</span> <span class="n">start_dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">).</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="n">loss</span><span class="p">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="p">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">process</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">.</span><span class="n">item</span><span class="p">())</span>
    <span class="k">print</span> <span class="p">(</span><span class="sa">f</span><span class="s">'[*] Test RMSE: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">process</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">process</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">process</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">process</span><span class="p">)</span>

<span class="c1"># run
</span></code></pre></div></div> <h3 id="run"><strong>run</strong></h3> <p>ì´ì œ ë‹¤ ëë‚¬ìŠµë‹ˆë‹¤. ì‹¤í–‰ë§Œ ë¹¼ê³ ìš”!ğŸ˜Š epochë§Œí¼ ë°˜ë³µì‹œí‚¤ê³ , ê°ê°ì˜ ê²°ê³¼ë¥¼ ì €ì¥í•œ í›„ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ë©´ ëª¨ë“  ì½”ë“œê°€ ì™„ì„±ë©ë‹ˆë‹¤.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">train_rmse</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">Tensor</span><span class="p">([]).</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">test_rmse</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">Tensor</span><span class="p">([]).</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">epochs</span><span class="p">):</span>
        <span class="n">train_rmse</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">cat</span><span class="p">((</span><span class="n">train_rmse</span><span class="p">,</span> <span class="n">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">)),</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">test_rmse</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">cat</span><span class="p">((</span><span class="n">train_rmse</span><span class="p">,</span> <span class="n">test</span><span class="p">()),</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">epochs</span><span class="p">),</span><span class="n">train_rmse</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">epochs</span><span class="p">),</span><span class="n">test_rmse</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'epoch'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'RMSE'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div> <h2 id="-conclusion">â— Conclusion</h2> <p><img src="https://user-images.githubusercontent.com/51329156/106496851-b3731080-6500-11eb-9bc1-5937d6605189.png" alt="Figure_2" /></p> <p>ì£¼í™©ìƒ‰ ì„ ì€ test ê²°ê³¼ ì´ê³ , íŒŒë€ìƒ‰ ì„ ì€ train ê²°ê³¼ì…ë‹ˆë‹¤. ê±°ì˜ ë¹„ìŠ·í•˜ë„¤ìš”. ì €ëŠ” epochì„ 30ìœ¼ë¡œ í–ˆëŠ”ë° ê²°ê³¼ë¥¼ ë³´ë‹ˆ 20ìœ¼ë¡œ í–ˆì„ ë•Œì™€ ë³„ ì°¨ì´ê°€ ì—†ìŠµë‹ˆë‹¤.</p> <h2 id="-ng">ğŸ” NG</h2> <p>ì´ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ì„œ ëª‡ê°€ì§€ ë¬¸ì œë“¤ì„ ë§ˆì£¼ì³¤ìŠµë‹ˆë‹¤â€¦ ê·¸ ë¶€ë¶„ì— ëŒ€í•´ ì œê°€ ìƒê°í•˜ëŠ” ì›ì¸ê³¼ í•´ê²°ë°©ë²•ì„ ë§ì”€ ë“œë¦¬ê³  ê¸€ì„ ë§ˆë¬´ë¦¬í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ì •í™•í•˜ì§„ ì•Šìœ¼ë‹ˆ ì°¸ê³ ë§Œ í•´ì£¼ì„¸ìš”!</p> <h3 id="1-lossê°€-ì¤„ì–´ë“¤ì§€-ì•ŠìŒ">1. Lossê°€ ì¤„ì–´ë“¤ì§€ ì•ŠìŒ</h3> <p>ì²˜ìŒì— ì½”ë“œë¥¼ ì§¤ ë•ŒëŠ” ratings.csvë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê³ , <strong>pandas</strong>ì˜ <code class="language-plaintext highlighter-rouge">pivot()</code>ì„ ì‚¬ìš©í•´ userì™€ itemì˜ interaction matrixë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ê·¸ë ‡ê²Œ ë˜ë©´ ì¤‘ê°„ì— ë¹ˆ ê°’ì´ ìƒê¸°ê²Œ ë˜ëŠ”ë°, <strong>numpy</strong>ì˜ <code class="language-plaintext highlighter-rouge">nonzero()</code>ë¥¼ ì‚¬ìš©í•´ ì±„ì›Œì§„ ê°’ë§Œ ê°€ì ¸ì˜¤ëŠ” ì‹ìœ¼ë¡œ í–ˆìŠµë‹ˆë‹¤. ê·¼ë° ì´ ë¶€ë¶„ì—ì„œ ì–´ë–¤ ë¬¸ì œê°€ ìˆì—ˆëŠ”ì§€â€¦ lossê°€ 15~18ì—ì„œ ì™”ë‹¤ê°”ë‹¤ í•˜ë©´ì„œ ë„ì €íˆ ê°ì†Œë¥¼ í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.. ê·¸ë˜ì„œ ê·¸ëƒ¥ ì›ë˜ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ëŒì•„ì™”ë”ë‹ˆ ì •ìƒí™”ë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ ì™€ì¤‘ì— ë°”ê¾¼ ê²Œ ë˜ ìˆì—ˆê¸° ë•Œë¬¸ì— í™•ì‹ ì€ ëª»í•˜ê² ì§€ë§Œ, ì œê°€ ìƒê°í•˜ê¸°ì—ëŠ” ê·¸ë ‡ìŠµë‹ˆë‹¤!</p> <h3 id="2--user--itemsum1-">2. (user * item).sum(1) ??</h3> <p>ì´ ë¶€ë¶„ì€ ë¬¸ì œë¼ê¸° ë³´ë‹¨ ì˜ë¬¸ì´ ë“¤ì–´ì„œ ë„£ì–´ë´¤ìŠµë‹ˆë‹¤.</p> <p>ìœ„ì˜ ì—°ì‚°ì€ userì™€ item í–‰ë ¬ì„ elemet wise í•˜ê²Œ ì—°ì‚°í•œ í›„, ê°™ì€ rowì— ìˆëŠ” ê°’ë“¤ì„ ë‹¤ ë”í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤. êµ¬ê¸€ë§ì„ í•´ë³´ë©´ ë§ì€ ì‚¬ëŒë“¤ì´ ì´ë ‡ê²Œ MFë¥¼ êµ¬í˜„í–ˆëŠ”ë°â€¦ ì €ëŠ” ì´í•´ê°€ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì €ëŠ” <code class="language-plaintext highlighter-rouge">matmul(user, item.T)</code>ë¥¼ í•´ì•¼ ì˜ë¯¸ìƒ ë§ì§€ ì•Šë‚˜ë¼ê³  ìƒê°í–ˆê±°ë“ ìš”. ì—¬ê¸°ì— ëŒ€í•´ì„œëŠ” ë” ì•Œì•„ë³´ëŠ” ì¤‘ì…ë‹ˆë‹¤!</p> <p>ì´ë ‡ê²Œ MFë¥¼ PyTorchë¡œ êµ¬í˜„í•˜ëŠ” ë°ì— ì„±ê³µí–ˆë„¤ìš”. ë‹¤ìŒì—ëŠ” ì•„ë˜ì˜ ìˆœì„œëŒ€ë¡œ ë…¼ë¬¸ì„ ì½ê³ , êµ¬í˜„í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤. ì£¼ë³€ì— ì¶”ì²œì‹œìŠ¤í…œì„ ê³µë¶€í•˜ëŠ” ì¹œêµ¬ê°€ ì—†ì–´ ì™¸ë¡œì› ëŠ”ë° ê°“ê°“ ì„ ë°°ë‹˜ <em>adldotori</em> ê»˜ì„œ ì´ê±¸ ì£¼ì…¨ìŠµë‹ˆë‹¤. ë” ì—´ì‹¬íˆ í•´ì•¼ê² ë„¤ìš”.. ê¸€ ì½ê³  ëª¨ë¥´ëŠ” ë¶€ë¶„ì€ ì œ í”„ë¡œí•„ì— ìˆëŠ” ì—°ë½ì²˜ë¡œ ì—°ë½ ì£¼ì‹œë©´ ë‹µë³€ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ˜†</p> <p><img src="https://user-images.githubusercontent.com/51329156/106468911-e0fc9180-64e1-11eb-8be7-cc61c51c3d8b.jpg" alt="KakaoTalk_20210201_224448751" /></p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script><!-- Author box --> <div class="card"> <div class="card-header"> About Jo Byeonggeun </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="https://www.bbangjo.kr/assets/img/authors/bbangjo.png" alt="Jo Byeonggeun" /> </div> <div class="col-md-6"> <p class="author_bio">Hello World</p> <p>Email : airmancho@korea.ac.kr</p> <p>Website : </p> <p class="profile-links"> <a class="social-link" href="https://github.com/bbangjooo" target="_blank"><i class="fab fa-github fa-fw"></i></a> </p> </div> </div> </div> </div> </div><div id="disqus_thread"></div> </article> <div id="disqus_thread"></div> <script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */ var disqus_config = function () { this.page.url = 'https://www.bbangjo.kr/blog/recsys-mfpytorch'; this.page.identifier = 'https://www.bbangjo.kr/blog/recsys-mfpytorch'; }; (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://blog-5znfc8zdfx.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About bbangjo</div> <div class="card-body"> <p class="author_bio">Hi, my name is Jo Byeonggeun.</p> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#Recommendation System"></div> <li class="tag-head"> <a href="/blog/categories/Recommendation System">Recommendation System</a> </li> <a name="Recommendation System"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="https://www.bbangjo.kr/">Home</a> </li> <li> <a href="https://www.bbangjo.kr/about">About</a> </li> <li> <a href="https://www.bbangjo.kr/blog">Blog</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --></div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>.Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="https://www.bbangjo.kr/assets/js/mode-switcher.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> <!-- olvy releases --> <!-- <script> var OlvyConfig = { organisation: "", target: "#olvy-target", type: "", view: { showSearch: true, compact: true, showHeader: true, /* only applies when widget type is embed. you cannot hide header for modal and sidebar widgets */ showUnreadIndicator: true, unreadIndicatorColor: "#FFA13AFF", unreadIndicatorPosition: "top-right" } }; </script> <script type="text/javascript" src="https://app.olvy.co/script.js" defer="defer"></script> --> </body> </html>
