<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> 추천시스템 개요 -bbangjo </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="Recommendation System Intro- 추천시스템 개요"> <meta name="keywords" content="추천시스템 개요, bbangjo, Recommendation System,"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="bbangjo" property="og:site_name" /> <meta content="추천시스템 개요" property="og:title" /> <meta content="article" property="og:type" /> <meta content="Recommendation System Intro" property="og:description" /> <meta content="https://www.bbangjo.kr/blog/recsys-intro" property="og:url" /> <meta content="2021-02-08T00:00:00+00:00" property="article:published_time" /> <meta content="https://www.bbangjo.kr/about/" property="article:author" /> <meta content="https://www.bbangjo.krhttps://user-images.githubusercontent.com/51329156/100213332-d35ee480-2f51-11eb-9d0b-20b17ed189d8.png" property="og:image" /> <meta content="Recommendation System" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="추천시스템 개요" /> <meta name="twitter:url" content="https://www.bbangjo.kr/blog/recsys-intro" /> <meta name="twitter:description" content="Recommendation System Intro" /> <link rel="stylesheet" href="https://www.bbangjo.kr/assets/css/main.css" /> <!-- <link rel="stylesheet" href="https://www.bbangjo.kr/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="https://www.bbangjo.kr/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="https://www.bbangjo.kr/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="https://www.bbangjo.kr/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="https://www.bbangjo.kr/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="https://www.bbangjo.kr/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'https://www.bbangjo.kr' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="https://www.bbangjo.kr/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="https://www.bbangjo.kr/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="https://www.bbangjo.kr/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="https://www.bbangjo.kr/assets/js/search.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!-- Maker widget <script> (function(d, h, m) { var js, fjs = d.getElementsByTagName(h)[0]; if (d.getElementById(m)) { return; } js = d.createElement(h); js.id = m; js.onload = function() { window.makerWidgetComInit({ position: "left", widget: "ofeeof264otl2l5g-zspk40eq2gaomj2n-higi2qphmveubksi" }); }; js.src = "https://makerwidget.com/js/embed.js"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "dhm"); </script> --> <!-- buy me a coffeee <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sujaykundu" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="right" data-x_margin="10" data-y_margin="10" ></script> --> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">bbangjo</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="https://www.bbangjo.kr/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="https://www.bbangjo.kr/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="https://www.bbangjo.kr/blog" >Blog</a > </li> </ul> </div> <!-- <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link" href="https://www.bbangjo.kr/get-started"> Get Started </a> </li> --> <!-- <li class="nav-item"> <a class="nav-link" id="olvy-target"> What's New </a> </li> --> <!-- <li class="nav-item"> <a class="nav-link" href="https://www.bbangjo.kr/styleguide"> Styleguide </a> </li> <li class="nav-item"> <button id="olvy-target" class="btn btn-dark"> What's New </button> </li> --> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <!-- <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher()" type="checkbox" name="checkbox" /> </li> --> </ul> </nav> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">추천시스템 개요</h1> <h4 class="post-meta">Recommendation System Intro</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="https://www.bbangjo.kr/blog/authors/bbangjo">bbangjo</a></span> </span > at <time datetime="2021-02-08 00:00:00 +0000" itemprop="datePublished" >Feb 8, 2021</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/recsys-intro" ></span> <div class="post-categories"> Category : <a href="/blog/categories/Recommendation System" >Recommendation System</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="https://user-images.githubusercontent.com/51329156/100213332-d35ee480-2f51-11eb-9d0b-20b17ed189d8.png" alt="" /> <br /> <br /> <h3 id="intro">Intro</h3> <p><img src="https://user-images.githubusercontent.com/51329156/100213332-d35ee480-2f51-11eb-9d0b-20b17ed189d8.png" alt="image" /></p> <p>추천 시스템을 공부하는 배경에는, 세상은 연결되어 있다는 사실이 있습니다. 세상은 저희가 생각하는 것보다도 훨씬 더 밀접하게 연결되어 있습니다. 위 그림에서 확인할 수 있듯이 사용자와 사용자간의 연결이 있고, 사용자와 아이템간의 연결이 있습니다. <code class="language-plaintext highlighter-rouge">u1</code>과 <code class="language-plaintext highlighter-rouge">u2</code>는 sns 상 친구이고, 두 사용자는 둘다 i1(<code class="language-plaintext highlighter-rouge">Shape of You</code>)를 좋아합니다. 이 뿐만이 아니라 아이템과 아이템 사이에도 같은 가수, 같은 장르인지에 따라 연결이 만들어집니다.</p> <p>추천 시스템을 크게 나누자면 두 가지가 있습니다.</p> <ul> <li><strong>Content-based filtering</strong> : 사용자나 아이템을 몇 가지 특징(이름, 제목, 장르, ..)으로 표현하고 같은 특징을 가진 다른 아이템을 추천하는 방식입니다. <strong>Collaborative filtering</strong>은 사용자와 아이템간의 상호작용을 분석하는 방법인 반면 이 방법은 아이템 자체끼리 비슷한지 비교하는 방법입니다. 아이템을 하나의 벡터로 표현한 다음, clustering 알고리즘을 통해 아이템을 여러 cluster로 나눕니다. 그리고 사용자가 선택한 아이템과 같은 cluster에 있는 다른 아이템을 추천하는 방식입니다. 이 방식은 과거에 사용자가 선택했던 아이템을 기반으로 추천해주기 때문에 한계가 많습니다.</li> <li><strong>Collaborative filtering</strong> : 사용자와 아이템 간의 상호작용 정보를 통해 사용자가 좋아할 만한 아이템을 추천합니다. 기본적인 개념은 사용자-아이템 상호작용 정보를 통해 비슷한 사용자 or 비슷한 아이템들을 찾아내서 선호할 만한 아이템을 추천하는 방식입니다. <strong>Content-based filtering</strong>과는 다르게 사용자나 아이템 자체의 특성을 추천에 사용하지 않습니다. 이 글에서는 이 방법에 대해 주로 설명하겠습니다.</li> </ul> <h3 id="overview-of-recommendation-engine">Overview of Recommendation Engine</h3> <p><img src="https://user-images.githubusercontent.com/51329156/100213911-9515f500-2f52-11eb-8cb3-3dfe16edfec8.png" alt="image" /></p> <p><strong>User interest</strong>, 즉 사용자가 아이템에 매기는 점수는 별점을 주는 행위와 같이 직접적(Explicit)으로 드러날 수도 있지만, 간접적(Implicit)인 방법으로 나타나는 경우도 있습니다. 이 때까지 사용자가 남긴 좋아요들, 웹페이지에 머무른 시간 등은 직접적으로 드러나지는 않지만 사용자의 interest를 나타낼 수 있습니다. 여기서 말하는 아이템은 영화, 친구, 뉴스 등등이 될 수 있습니다.</p> <p>여기서 문제는, <strong>User</strong>와 <strong>Item</strong>간에 존재하는 차이를 어떻게 해결하느냐 입니다. 당연하게도 사용자와 아이템은 다른 타입의 개체이기 때문에 사용자는 사용자의 특성에 의해 표현되고, 아이템은 아이템의 특성에 맞게 표현될 것입니다. 이러한 차이가 있음에도 불구하고, 아이템에 대한 사용자의 <strong>User interest</strong>를 구하는 게 주 목적이라 보시면 됩니다.</p> <p>이 내용과 위 그림을 공식화해봅시다. <strong>Input</strong>은 이 때까지 사용자가 아이템들과 해온 interaction의 기록들과 추가적인 정보들(사용자의 국적 등)이 될 수 있습니다. <strong>Output</strong>에는 사용자가 아이템을 얼마나 좋아할지 점수로 나타내고 점수가 높은 TOP-N 아이템이 올 수 있습니다. 혹은 사용자가 아직 평가하지 않은 아이템에 대해 어떻게 평가할지를 예측한 값이 올 수 있습니다. 예를 들어 준용이가 테넷을 얼마나 좋아하는지 예측할 때, <strong>Input</strong>으로는 이 때까지 사용자가 다른 아이템들에 매긴 별점을 넣고, <strong>Output</strong>에 준용이가 테넷에 매길 것 같은 별점을 내 놓는 것입니다.</p> <h3 id="추천-시스템이-풀고자-하는-문제">추천 시스템이 풀고자 하는 문제</h3> <p><strong>랭킹 문제</strong></p> <p>사용자가 아이템에 남길 평점(점수)를 정확하게 예측할 필요가 없습니다. 대신 특정 사용자가 좋아할만한 Top-N 아이템을 선정하거나, 특정 아이템을 좋아할만한 Top-N 사용자를 선정할 수 있습니다. 정확한 점수보다는 대상간의 순서가 중요한 문제입니다.</p> <p><strong>예측 문제</strong></p> <p>사용자-아이템 조합에서 평점(점수)를 정확히 예측하는 것을 목표로 합니다. 사용자-아이템 행렬을 채우는 문제로도 볼 수 있습니다. 사용자(m) x 아이템(n) 의 m X n 행렬에서 비어있는 부분이 존재할 때, 관측값(채워져있는 값)은 모델 학습에 사용하고, 결측값(비어있는 값)은 모델 평가에 사용합니다.</p> <h2 id="협업-필터링collaborative-filtering">협업 필터링(Collaborative Filtering)</h2> <p><strong>협업 필터링</strong>은 <strong>User interest</strong>를 예측할 때 많은 사용자들로부터 모은 취향 정보들을 이용해 예측하는 기술을 의미합니다. 예를 들어서 준용이와 승윤이의 영화취향이 비슷할 때, 승윤이가 테넷을 좋아할 것인가? 에 대해서는 <strong>YES</strong>라고 판단합니다. (예제는 위와 이어집니다). 즉 비슷한 사용자들은 아마도 비슷한 취향을 가지고 있을 것이라고 예측합니다.</p> <p><strong>협업 필터링</strong>의 종류에는 Memory-based CF, Model-based CF, Hybrid가 있습니다.</p> <ul> <li><strong>memory-based</strong> : 데이터로 주어지는 사용자-아이템 상호작용 행렬을 그대로 다 활용해서 사용자의 rating을 예측하는 방법입니다.</li> <li><strong>model-based</strong> : 사용자-아이템 상호작용 행렬을 통해 model을 학습시키고 이 모델을 가지고 rating을 예측하는 방법입니다.</li> </ul> <h3 id="memory-based-cf">Memory-based CF</h3> <p><img src="https://user-images.githubusercontent.com/51329156/100218541-381d3d80-2f58-11eb-8d71-438e9ed9112f.png" alt="image" /></p> <p>위 그림에서 보면 u1는 i1에 대해 별점 5점을 남겼고, 다른 아이템들에 대해서는 별점을 남기지 않았습니다. 현실에서 실제로 사용자들이 모든 아이템에 별점을 남기지는 않습니다.</p> <p>여기서 저희가 해결해야 하는 문제가 빨간색 표시가 된 부분(u1의 i4에 대한 평가)을 예측하는 것이라고 해봅시다. <strong>Memory-based CF</strong>는 유사도를 기반하여 동작합니다. 이 때 말하는 유사도는 사용자와 사용자간의 유사도가 될 수도 있고, 아이템과 아이템간의 유사도가 될 수도 있습니다. 사용자 사이의 유사도를 기준으로 하는 경우는 <strong>User-based</strong>, 아이템 사이의 유사도를 기준으로 하는 경우는 <strong>Item-based</strong>이라고 합니다.</p> <table> <thead> <tr> <th> </th> <th>테넷</th> <th>인터스텔라</th> <th>겨울왕국</th> <th>어바웃 타움</th> </tr> </thead> <tbody> <tr> <td>준용</td> <td>5</td> <td>4</td> <td>?</td> <td>2</td> </tr> <tr> <td>승윤</td> <td>?</td> <td>4</td> <td>1</td> <td>5</td> </tr> <tr> <td>동욱</td> <td>1</td> <td>?</td> <td>5</td> <td>?</td> </tr> <tr> <td>서연</td> <td>?</td> <td>?</td> <td>3</td> <td>4</td> </tr> <tr> <td>무열</td> <td>5</td> <td>3</td> <td>3</td> <td>?</td> </tr> </tbody> </table> <p><strong>사용자 기반 (User-Based)</strong></p> <p>사용자 기반에서는 한 사용자가 평가한 영화들의 평점들을 가지고 벡터로 표현합니다. 위의 표를 보면 준용의 평가 벡터는 <code class="language-plaintext highlighter-rouge">(5,4,-,2)</code>이고 승윤의 평가 벡터는 <code class="language-plaintext highlighter-rouge">(-,4,1,5)</code>입니다. 이 때 두 사용자간 유사도는 두 벡터 간 유사도로 정의합니다. 식으로 나타내면 다음과 같습니다 :</p> <p><img src="https://user-images.githubusercontent.com/51329156/100496370-f62e0a80-3196-11eb-87d2-526179d9084d.png" alt="image" /></p> <p>유사도를 구하는 방법에는 여러가지가 있지만 이번에는 간단한 코사인 유사도를 사용하겠습니다.</p> <p>코사인 유사도를 이용해 사용자 간 유사도를 구할 때는 두 사용자가 공통으로 평가한 항목에 대해서만 계산합니다. 즉 준용과 승윤의 유사도를 계산할 때 <code class="language-plaintext highlighter-rouge">A=(4,2)</code>,<code class="language-plaintext highlighter-rouge">B=(4,5)</code>이고 코사인 유사도를 구해보면 다음과 같습니다 :</p> <p><img src="https://user-images.githubusercontent.com/51329156/100496381-0cd46180-3197-11eb-89d2-c6153d8d7a0e.png" alt="image" /></p> <p>이런 식으로 모든 사용자 간의 유사도를 구하면 사용자 수 * 사용자 수(5*5) 크기의 유사도 행렬을 만들 수 있습니다. 만약 동욱이 인터스텔라에 남긴 평점을 구하고 싶으면 유사한 몇명의 점수를 이용해 구하거나 전체를 대상으로 weight sum 값을 사용할 수 있습니다. 전자를 식으로 나타내면 다음과 같습니다 :</p> <p><img src="https://user-images.githubusercontent.com/51329156/100496388-165dc980-3197-11eb-9533-5ebc52746bad.png" alt="image" /></p> <p>위의 수식은 유사한 사용자들을 구해 (그 사용자와의 유사도 * 그 사용자의 예측값)들의 합을 예측값으로 사용하는 것을 의미합니다. 후자의 경우인 전체를 대상으로 weight sum 값을 사용하는 경우의 수식은 다음과 같습니다 :</p> <p><img src="https://user-images.githubusercontent.com/51329156/100496394-22e22200-3197-11eb-859d-3234d0c01b1d.png" alt="image" /></p> <p><strong>아이템 기반 (item-Based)</strong></p> <p>아이템 기반은 아이템에 대해 사용자들이 어떤 식으로 평가했는지를 바탕으로 유사도를 계산합니다. 위의 행렬을 참고해서 테넷과 인터스텔라의 유사도를 구해봅시다. 테넷과 인터스텔라 모두를 평가한 사용자는 준용, 무열이고 각각을 벡터로 나타내면 <code class="language-plaintext highlighter-rouge">(5,4)</code>,<code class="language-plaintext highlighter-rouge">(5,3)</code> 입니다 :</p> <p><img src="https://user-images.githubusercontent.com/51329156/100496399-32616b00-3197-11eb-8d2b-bf6ee652b039.png" alt="image" /></p> <p>테넷과 인터스텔라의 유사도는 0.99로 상당힌 높은 유사도 입니다. 즉 테넷을 좋아하는 사람은 인터스텔라를 좋아할 확률이 높고 그 반대도 마찬가지임을 의미합니다.</p> <h3 id="model-based-cf">Model-based CF</h3> <p>사용자-아이템 interaction 행렬을 통해 model을 학습시키는 방법입니다. 학습시키고 나면 추천할 때는 model만 있으면 됩니다. 때문에 <strong>memory-based</strong>에 비해 scalability와 추천속도가 뛰어납니다. 여기서는 Latent Factor Model의 일종인 Matrix Factorization을 살펴보겠습니다.</p> <p><strong>Matrix Factorization(행렬 인수분해)</strong></p> <p>바로 위에서 Matrix Factorization(MF)는 Latent Factor 모델의 일종이라고 했습니다. Latent Factor 모델이 하고 싶은 것은, 사용자와 아이템을 각각 20-100 차원 정도의 vector로 표현하는 것입니다. 이 벡터는 기존 데이터에서 나타나는 rating 정보를 이용해 학습합니다. 즉 원래 사용자-아이템 상호작용 행렬을 사용자, 아이템 각각의 행렬로 쪼개는데, 곱했을 때 상호작용 행렬이 잘 나타나지도록 각각의 vector를 학습시키는 것이 목표입니다. <strong>content-based</strong> 방법에서 아이템을 제목, 장르, 가수 등으로 표현했다면 latent factor 모델에서는 상호작용 행렬을 통해 학습된, 기계가 이해하는 특징들로 표현합니다. 때문에 <strong>content-based</strong>보다 훨씬 풍부한 정보를 표현할 수 있습니다.</p> <p>사용자와 아이템을 각각 vector로 나타낸다고 했는데, 이 때 두 vector의 차원은 같게 만듭니다. 아래의 예제는 latent factor 모델을 단순화시킨 그림입니다. x축은 양의 방향으로 갈수록 남성임을 의미하고, y축은 양의 방향으로 갈수록 Serious한 정도가 높음을 의미합니다 :</p> <p><img src="https://dnddnjs.github.io/assets/img/Untitled-87d5c1c7-f6ef-44a6-ab29-fde9a30d609d.png" alt="" /></p> <p>Latent factor 모델에서 사용자와 아이템의 latent factor가 각 차원마다 같은 의미를 가지고, 사용자와 아이템 latent factor 끼리 dot-product 값이 높으면 추천하는 방식입니다. 위 그림에서는 <strong>Gus</strong>에게 <code class="language-plaintext highlighter-rouge">Dumb and Dumber</code>를 추천하고 <code class="language-plaintext highlighter-rouge">The Color Purple</code>은 추천하지 않겠네요.</p> <p>Matrix Factorization을 식으로 나타낼 수 있습니다. 여기서 q는 item latent factor matrix 이고 p는 user latent factor matrix 입니다. 사용자 u의 아이템 i에 대한 rating을 식으로 나타내면 다음과 같습니다 :</p> <p><img src="https://user-images.githubusercontent.com/51329156/100550029-52d61600-32ba-11eb-81fa-16cd51b7636f.png" alt="image" /></p> <p>그림으로 보면 이해가 쉽습니다. MF를 처음 설명할 때 언급한 내용인데, MF는 사용자-아이템 행렬을 user latent factor matrix와 item latent factor matrix로 쪼개는 것입니다. 그리고 쪼개진 q와 p(아래 그림에서는 U와 V)를 곱했을 때 원래 사용자-아이템 행렬을 잘 만들어내는 것이 MF 학습의 핵심입니다.</p> <p><img src="https://buildingrecommenders.files.wordpress.com/2015/11/matrix-factorisation.png?w=900" alt="" /></p> <p>MF의 objective function은 다음과 같이 정의할 수 있습니다. 목표는 원래 rating을 예측하는 것으로, loss는 MSE loss를 사용합니다. 아래 식에서 K는 rating이 알려진 사용자-아이템 쌍을 말합니다. 위 그림에서는 노란색 표시가 된 경우를 얘기합니다. 이 때 MSE loss만 최소가 되게 학습시키면 되겠다고 생각할 수 있지만, 그러면 overfitting이 발생하게 됩니다. 그래서 <strong>L2 regularization</strong>을 사용합니다. <strong>L2 regularization</strong>은 overfitting을 막기 위해 cost function에 가중치의 제곱을 더하면서 학습하는 방식입니다.</p> <p><img src="https://user-images.githubusercontent.com/51329156/100550370-edcfef80-32bc-11eb-90c5-6757f62afe85.png" alt="image" /></p> <p>위 objective function을 최소화하는 p와 q를 찾는 것이 목적이고, 이를 위한 방법은 생략하도록 하겠습니다.</p> <h3 id="deep-learning-meets-cf">Deep Learning Meets CF</h3> <p><strong>Methods of Representation Learning(표현 학습)</strong></p> <p>DNN이 높은 성능을 내는 배경에는 복잡한 데이터 공간을 선형 분류가 가능할 정도로 단순화해 표현하기 때문이라는 이론이 있습니다. <strong>표현학습</strong>은 특정 task를 수행하기에 좋은 표현을 만드는 것을 의미합니다. 아래 그림에서는 Matrix Factorization과 표현학습을 사용한 것을 설명하고 있습니다 :</p> <p><img src="https://user-images.githubusercontent.com/51329156/101655831-684efb00-3a85-11eb-9dd3-4963d047d482.png" alt="image" /></p> <p>유저 Row에 대해 DNN을 사용해 Representation을 얻고, 아이템 Column에 대해서도 마찬가지로 Representation을 얻습니다. 그리고 그 얻은 두 표현을 이용해 Score를 얻습니다. 이 값이 높으면 User i가 Item j를 좋아한다고 판단하는 것입니다. Representation을 얻는다는 게 별 다른 게 아닙니다. MNIST 이미지를 받아서 0~9 사이의 숫자 중 무엇인지 판별하는 문제를 풀 때 MNIST 이미지를 여러 Layer를 거쳐 10차원의 데이터로 표현합니다. 이 과정도 마찬가지로 <strong>Representation Learning</strong>이라고 할 수 있습니다.</p> <h3 id="updating-">Updating …</h3> <blockquote> <p>Reference</p> <p>🚀 <a href="https://next-nus.github.io/slides/tuto-cikm2019-public.pdf">https://next-nus.github.io/slides/tuto-cikm2019-public.pdf</a></p> <p>🚀 <a href="https://scvgoe.github.io/2017-02-01-%ED%98%91%EC%97%85-%ED%95%84%ED%84%B0%EB%A7%81-%EC%B6%94%EC%B2%9C-%EC%8B%9C%EC%8A%A4%ED%85%9C-(Collaborative-Filtering-Recommendation-System)/">협업 필터링 추천 시스템 (Collaborative Filtering Recommendation System)</a></p> <p>🚀 <a href="https://dnddnjs.github.io/recomm/2019/08/15/recommendation_system_basics/">추천 시스템 Basics</a></p> <p>🚀 <a href="https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf">https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf</a></p> <p>🚀 <a href="https://buildingrecommenders.wordpress.com/2015/11/18/overview-of-recommender-algorithms-part-2/">Overview of Recommender Algorithms – Part 2</a></p> </blockquote> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script><!-- Author box --> <div class="card"> <div class="card-header"> About Jo Byeonggeun </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="https://www.bbangjo.kr/assets/img/authors/bbangjo.png" alt="Jo Byeonggeun" /> </div> <div class="col-md-6"> <p class="author_bio">Hello World</p> <p>Email : airmancho@korea.ac.kr</p> <p>Website : </p> <p class="profile-links"> <a class="social-link" href="https://github.com/bbangjooo" target="_blank"><i class="fab fa-github fa-fw"></i></a> </p> </div> </div> </div> </div> </div><div id="disqus_thread"></div> </article> <div id="disqus_thread"></div> <script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */ var disqus_config = function () { this.page.url = 'https://www.bbangjo.kr/blog/recsys-intro'; this.page.identifier = 'https://www.bbangjo.kr/blog/recsys-intro'; }; (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://blog-5znfc8zdfx.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About bbangjo</div> <div class="card-body"> <p class="author_bio">Hi, my name is Jo Byeonggeun.</p> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#Recommendation System"></div> <li class="tag-head"> <a href="/blog/categories/Recommendation System">Recommendation System</a> </li> <a name="Recommendation System"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="https://www.bbangjo.kr/">Home</a> </li> <li> <a href="https://www.bbangjo.kr/about">About</a> </li> <li> <a href="https://www.bbangjo.kr/blog">Blog</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --></div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>.Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="https://www.bbangjo.kr/assets/js/mode-switcher.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> <!-- olvy releases --> <!-- <script> var OlvyConfig = { organisation: "", target: "#olvy-target", type: "", view: { showSearch: true, compact: true, showHeader: true, /* only applies when widget type is embed. you cannot hide header for modal and sidebar widgets */ showUnreadIndicator: true, unreadIndicatorColor: "#FFA13AFF", unreadIndicatorPosition: "top-right" } }; </script> <script type="text/javascript" src="https://app.olvy.co/script.js" defer="defer"></script> --> </body> </html>
